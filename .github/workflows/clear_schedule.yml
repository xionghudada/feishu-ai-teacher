name: 每天定时清空表格

on:
  # 允许手动点击按钮触发
  workflow_dispatch:
  
  # 定时任务
  schedule:
    # -------------------------------------------------------
    # 1. 周一至周五 (Mon-Fri)
    # 北京时间 17:00 (UTC 09:00)
    # -------------------------------------------------------
    - cron: '0 9 * * 1-5'

    # -------------------------------------------------------
    # 2. 周六 (Sat)
    # 北京时间 24:00 (UTC 16:00)
    # -------------------------------------------------------
    - cron: '0 16 * * 6'
    
    # 周日(Sun) 不运行，数据保留至周一

jobs:
  clear_data:
    runs-on: ubuntu-latest
    
    steps:
    - name: 拉取代码
      uses: actions/checkout@v3
      
    - name: 设置 Python 环境
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: 安装依赖库
      run: pip install lark-oapi
      
    - name: 执行清空脚本
      env:
        APP_ID: ${{ secrets.APP_ID }}
        APP_SECRET: ${{ secrets.APP_SECRET }}
        APP_TOKEN: ${{ secrets.APP_TOKEN }}
        TABLE_ID: ${{ secrets.TABLE_ID }}
      run: python clear_data.py
